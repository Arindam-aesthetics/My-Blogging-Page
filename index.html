<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>My Blog</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400;0,600;0,700;1,400&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet" />
  <style>
    *, *::before, *::after { box-sizing: border-box; }
    html { -webkit-text-size-adjust: 100%; scroll-behavior: smooth; }
    body { margin: 0; background: #faf9f7; font-family: 'Lora', Georgia, serif; overscroll-behavior-y: none; color: #1a1a1a; }
    button, input, textarea { -webkit-appearance: none; appearance: none; font-family: inherit; }
    img { max-width: 100%; height: auto; display: block; }
    ::-webkit-scrollbar { width: 5px; }
    ::-webkit-scrollbar-track { background: #faf9f7; }
    ::-webkit-scrollbar-thumb { background: #ddd; border-radius: 3px; }

    @keyframes fadeUp   { from{opacity:0;transform:translateY(14px)} to{opacity:1;transform:translateY(0)} }
    @keyframes shake    { 0%,100%{transform:translateX(0)} 25%{transform:translateX(-8px)} 75%{transform:translateX(8px)} }
    @keyframes scaleIn  { from{opacity:0;transform:scale(0.95)} to{opacity:1;transform:scale(1)} }
    @keyframes spin     { to{transform:rotate(360deg)} }
    @keyframes heartPop { 0%{transform:scale(1)} 40%{transform:scale(1.4)} 70%{transform:scale(0.9)} 100%{transform:scale(1)} }

    .view { display:none; }
    .view.active { display:block; }

    /* NAV */
    .site-nav { position:sticky;top:0;z-index:10;background:rgba(250,249,247,0.96);backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);border-bottom:1px solid #ece9e4;padding:0.85rem 1.1rem;display:flex;justify-content:space-between;align-items:center; }
    @media(min-width:600px){.site-nav{padding:1rem 2rem}}
    .nav-logo { font-size:1rem;font-weight:600;color:#1a1a1a;font-family:'Lora',Georgia,serif; }
    .nav-right { display:flex;align-items:center;gap:0.65rem; }

    /* BUTTONS */
    .btn-primary { display:inline-flex;align-items:center;justify-content:center;padding:0.65rem 1.4rem;background:#2c2c2c;color:#fff;border:none;border-radius:8px;cursor:pointer;font-family:'DM Sans',sans-serif;font-size:0.88rem;font-weight:500;min-height:44px;transition:background 0.18s,transform 0.12s;-webkit-tap-highlight-color:transparent;white-space:nowrap; }
    .btn-primary:active{transform:scale(0.97);background:#111}
    .btn-primary:disabled{background:#ccc;cursor:not-allowed}
    .btn-ghost { display:inline-flex;align-items:center;justify-content:center;padding:0.6rem 1.2rem;background:transparent;color:#777;border:1.5px solid #e0dcd8;border-radius:8px;cursor:pointer;font-family:'DM Sans',sans-serif;font-size:0.88rem;min-height:44px;transition:border-color 0.18s,color 0.18s;-webkit-tap-highlight-color:transparent;white-space:nowrap; }
    .btn-ghost:active{border-color:#bbb;color:#444}
    .btn-danger { display:inline-flex;align-items:center;justify-content:center;padding:0.6rem 1.2rem;background:transparent;color:#e0827c;border:1.5px solid #e0827c;border-radius:8px;cursor:pointer;font-family:'DM Sans',sans-serif;font-size:0.88rem;min-height:44px;-webkit-tap-highlight-color:transparent;white-space:nowrap; }
    .btn-danger:active{background:#fdf0ef}
    .btn-text { background:none;border:none;cursor:pointer;font-family:'DM Sans',sans-serif;font-size:0.78rem;color:#9b8ea0;padding:0.5rem;min-height:44px;-webkit-tap-highlight-color:transparent; }
    .btn-nav-new { display:none;border-radius:20px!important;padding:0.45rem 1.1rem!important;font-size:0.8rem!important;min-height:36px!important; }
    @media(min-width:600px){.btn-nav-new{display:inline-flex}}

    /* FAB */
    .fab { position:fixed;bottom:calc(1.5rem + env(safe-area-inset-bottom,0px));right:1.25rem;width:54px;height:54px;background:#2c2c2c;color:#fff;border:none;border-radius:50%;font-size:1.5rem;cursor:pointer;box-shadow:0 6px 24px rgba(0,0,0,0.2);display:none;align-items:center;justify-content:center;z-index:50;-webkit-tap-highlight-color:transparent;transition:transform 0.15s,box-shadow 0.15s; }
    .fab:active{transform:scale(0.92);box-shadow:0 3px 12px rgba(0,0,0,0.15)}
    .fab.visible{display:flex}
    @media(min-width:600px){.fab{display:none!important}}

    /* HERO */
    .hero { max-width:760px;margin:0 auto;padding:2.25rem 1.1rem 1.75rem; }
    @media(min-width:600px){.hero{padding:3.5rem 2rem 2.5rem}}
    .hero h1 { font-size:clamp(2rem,9vw,2.5rem);font-weight:700;color:#1a1a1a;line-height:1.2;margin:0 0 0.85rem;font-family:'Lora',Georgia,serif; }
    @media(min-width:600px){.hero h1{font-size:clamp(2.4rem,5vw,3.2rem)}}
    .hero p { font-size:0.93rem;color:#8a8078;line-height:1.8;max-width:460px;margin:0;font-family:'Lora',Georgia,serif; }
    @media(min-width:600px){.hero p{font-size:1rem}}
    .hero-divider { margin-top:1.4rem;height:2px;width:36px;background:#2c2c2c;border-radius:2px; }

    /* POSTS */
    .posts-main { max-width:760px;margin:0 auto;padding:0 1.1rem calc(5.5rem + env(safe-area-inset-bottom,0px)); }
    @media(min-width:600px){.posts-main{padding:0 2rem 6rem}}
    .posts-grid { display:grid;grid-template-columns:1fr;gap:0.9rem; }
    @media(min-width:600px){.posts-grid{grid-template-columns:repeat(2,1fr);gap:1.2rem}}
    .empty-state { text-align:center;padding:4rem 0;color:#c0b8b0;font-family:'DM Sans',sans-serif;font-size:0.9rem; }
    .empty-state p { margin:0 0 1.25rem; }

    /* POST CARD */
    .post-card { cursor:pointer;background:#fff;border:1px solid #ece9e4;border-radius:14px;overflow:hidden;transition:box-shadow 0.22s ease,transform 0.22s ease,border-color 0.22s ease;animation:fadeUp 0.38s ease both;-webkit-tap-highlight-color:transparent; }
    .post-card:active{transform:scale(0.98)}
    @media(hover:hover){.post-card:hover{box-shadow:0 8px 32px rgba(0,0,0,0.08);transform:translateY(-3px);border-color:#d5d0cb}}
    .post-card-img { width:100%;height:195px;object-fit:cover;display:block; }
    .post-card-body { padding:1.2rem 1.3rem 1.1rem; }
    .post-meta { display:flex;gap:0.65rem;align-items:center;flex-wrap:wrap;margin-bottom:0.6rem; }
    .post-meta span { font-size:0.69rem;color:#b0a9a0;font-family:'DM Sans',sans-serif; }
    .post-meta .dot { color:#e0dcd8; }
    .post-card-title { font-size:1.12rem;font-weight:700;color:#1a1a1a;line-height:1.35;margin:0 0 0.6rem;font-family:'Lora',Georgia,serif;word-break:break-word; }
    .post-card-excerpt { font-size:0.87rem;color:#7a7470;line-height:1.75;margin:0;font-family:'Lora',Georgia,serif;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden; }
    .post-card-footer { margin-top:1rem;padding-top:0.85rem;border-top:1px solid #f2efe9;display:flex;align-items:center;justify-content:space-between; }
    .card-read-more { font-size:0.74rem;color:#9b8ea0;font-family:'DM Sans',sans-serif;letter-spacing:0.04em; }
    .card-likes { display:flex;align-items:center;gap:4px;font-size:0.72rem;color:#b0a9a0;font-family:'DM Sans',sans-serif; }

    /* POST VIEW */
    #view-post .post-nav { padding:0.85rem 1rem;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #ece9e4;background:rgba(250,249,247,0.96);backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);position:sticky;top:0;z-index:10; }
    @media(min-width:600px){#view-post .post-nav{padding:1rem 1.5rem}}
    .btn-back { background:none;border:none;cursor:pointer;font-family:'DM Sans',sans-serif;font-size:0.88rem;color:#888;display:flex;align-items:center;gap:6px;padding:0.5rem 0;min-height:44px;min-width:44px;-webkit-tap-highlight-color:transparent; }
    .post-admin-btns { display:flex;gap:0.5rem; }
    .post-article { max-width:680px;margin:0 auto;padding:1.75rem 1.15rem 1rem; }
    @media(min-width:600px){.post-article{padding:3rem 1.5rem 1.5rem}}
    .post-cover-img { width:100%;border-radius:10px;margin-bottom:1.5rem;object-fit:cover;max-height:260px; }
    @media(min-width:600px){.post-cover-img{border-radius:14px;margin-bottom:2.25rem;max-height:420px}}
    .post-article .post-meta { margin-bottom:0.9rem; }
    .post-article .post-meta span { font-size:0.73rem; }
    .post-article h1 { font-size:clamp(1.55rem,7.5vw,2rem);font-weight:700;color:#1a1a1a;line-height:1.25;margin:0 0 1.4rem;font-family:'Lora',Georgia,serif;word-break:break-word; }
    @media(min-width:600px){.post-article h1{font-size:clamp(1.9rem,4vw,2.6rem);margin-bottom:1.9rem}}
    .prose { font-size:clamp(1rem,2.6vw,1.08rem);line-height:1.92;color:#3a3535;white-space:pre-wrap;font-family:'Lora',Georgia,serif;word-break:break-word;overflow-wrap:break-word; }

    /* ‚îÄ‚îÄ LIKE / SHARE / COMMENT BAR ‚îÄ‚îÄ */
    .post-actions { max-width:680px;margin:0 auto;padding:0 1.15rem; }
    @media(min-width:600px){.post-actions{padding:0 1.5rem}}
    .actions-bar {
      display:flex;align-items:center;gap:0.5rem;
      padding:1rem 0; border-top:1px solid #ece9e4; border-bottom:1px solid #ece9e4;
      margin-bottom:2rem;
    }
    .action-btn {
      display:inline-flex;align-items:center;gap:6px;
      background:none;border:1.5px solid #e8e4df;border-radius:20px;
      padding:0.5rem 1rem;cursor:pointer;
      font-family:'DM Sans',sans-serif;font-size:0.8rem;color:#888;
      transition:all 0.18s;-webkit-tap-highlight-color:transparent;
      min-height:38px;
    }
    .action-btn:active{transform:scale(0.96)}
    .action-btn.liked { background:#fff0f0;border-color:#f0a0a0;color:#e05050; }
    .action-btn .icon { font-size:1rem;line-height:1; }
    .action-btn.like-btn.liked .icon { animation: heartPop 0.35s ease; }

    /* ‚îÄ‚îÄ COMMENTS ‚îÄ‚îÄ */
    .comments-section { max-width:680px;margin:0 auto;padding:0 1.15rem calc(4rem + env(safe-area-inset-bottom,0px)); }
    @media(min-width:600px){.comments-section{padding:0 1.5rem calc(4rem + env(safe-area-inset-bottom,0px))}}
    .comments-title { font-size:0.78rem;letter-spacing:0.15em;text-transform:uppercase;color:#b0a9a0;font-family:'DM Sans',sans-serif;margin:0 0 1.25rem; }
    .comment-form { background:#fff;border:1px solid #ece9e4;border-radius:14px;padding:1.1rem 1.2rem;margin-bottom:1.75rem; }
    .comment-name-input {
      width:100%;border:none;border-bottom:1px solid #ece9e4;outline:none;
      font-family:'DM Sans',sans-serif;font-size:0.88rem;color:#1a1a1a;
      padding:0 0 0.6rem;margin-bottom:0.85rem;background:transparent;
    }
    .comment-name-input::placeholder { color:#c0b8b0; }
    .comment-text-input {
      width:100%;border:none;outline:none;resize:none;
      font-family:'Lora',Georgia,serif;font-size:0.95rem;color:#3a3535;
      line-height:1.7;min-height:80px;background:transparent;
      display:block;padding:0;
    }
    .comment-text-input::placeholder { color:#c8c0b8; }
    .comment-form-footer { display:flex;justify-content:flex-end;margin-top:0.85rem;padding-top:0.75rem;border-top:1px solid #f2efe9; }
    .btn-post-comment { padding:0.5rem 1.2rem;background:#2c2c2c;color:#fff;border:none;border-radius:20px;cursor:pointer;font-family:'DM Sans',sans-serif;font-size:0.8rem;min-height:36px;transition:background 0.18s,transform 0.12s;-webkit-tap-highlight-color:transparent; }
    .btn-post-comment:active{transform:scale(0.96);background:#111}
    .btn-post-comment:disabled{background:#ccc;cursor:not-allowed}
    .comments-list { display:flex;flex-direction:column;gap:1rem; }
    .comment-item { background:#fff;border:1px solid #ece9e4;border-radius:12px;padding:1rem 1.15rem; }
    .comment-header { display:flex;justify-content:space-between;align-items:center;margin-bottom:0.5rem; }
    .comment-author { font-family:'DM Sans',sans-serif;font-size:0.82rem;font-weight:500;color:#2c2c2c; }
    .comment-date { font-family:'DM Sans',sans-serif;font-size:0.68rem;color:#c0b8b0; }
    .comment-text { font-family:'Lora',Georgia,serif;font-size:0.9rem;color:#3a3535;line-height:1.7;margin:0;white-space:pre-wrap;word-break:break-word; }
    .comment-delete { background:none;border:none;cursor:pointer;color:#ddd;font-size:0.75rem;padding:0.2rem;-webkit-tap-highlight-color:transparent;transition:color 0.15s; }
    .comment-delete:hover { color:#e0827c; }
    .no-comments { font-family:'DM Sans',sans-serif;font-size:0.85rem;color:#c8c0b8;text-align:center;padding:2rem 0; }

    /* EDITOR */
    .editor-topbar { position:sticky;top:0;z-index:20;background:rgba(250,249,247,0.96);backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);border-bottom:1px solid #ece9e4;padding:0.8rem 1rem;display:flex;justify-content:space-between;align-items:center;gap:0.5rem; }
    @media(min-width:600px){.editor-topbar{padding:0.9rem 1.5rem}}
    .editor-label { font-size:0.7rem;letter-spacing:0.18em;text-transform:uppercase;color:#9b8ea0;font-family:'DM Sans',sans-serif;flex-shrink:0; }
    .editor-topbar-btns { display:flex;gap:0.5rem; }
    .editor-body-wrap { max-width:720px;margin:0 auto;padding:1.5rem 1.1rem 5rem; }
    @media(min-width:600px){.editor-body-wrap{padding:2rem 1.5rem 5rem}}
    .cover-upload-zone { width:100%;height:130px;border:2px dashed #e0dcd8;border-radius:12px;cursor:pointer;display:flex;align-items:center;justify-content:center;margin-bottom:1.5rem;overflow:hidden;background:#fff;position:relative; }
    @media(min-width:600px){.cover-upload-zone{height:170px}}
    .cover-upload-placeholder { text-align:center;color:#c0b8b0;font-family:'DM Sans',sans-serif; }
    .cover-upload-placeholder .icon { font-size:1.6rem;margin-bottom:5px; }
    .cover-upload-placeholder .hint { font-size:0.76rem; }
    .cover-remove-btn { position:absolute;top:10px;right:10px;background:rgba(0,0,0,0.5);color:#fff;border:none;border-radius:50%;width:34px;height:34px;display:flex;align-items:center;justify-content:center;font-size:0.9rem;cursor:pointer; }
    .editor-title-input { width:100%;font-size:clamp(1.45rem,5.5vw,2rem);font-weight:700;border:none;background:transparent;outline:none;color:#1a1a1a;font-family:'Lora',Georgia,serif;margin-bottom:1.25rem;line-height:1.3;display:block;padding:0; }
    .editor-content-input { width:100%;min-height:50vh;font-size:1.02rem;line-height:1.9;border:none;background:transparent;outline:none;color:#3a3535;font-family:'Lora',Georgia,serif;resize:none;display:block;padding:0; }
    .editor-footer { margin-top:1.25rem;padding:0.9rem 0;border-top:1px solid #ece9e4;font-size:0.73rem;color:#c0b8b0;font-family:'DM Sans',sans-serif; }

    /* TOAST */
    .saving-toast { position:fixed;bottom:calc(1.5rem + env(safe-area-inset-bottom,0px));left:50%;transform:translateX(-50%) translateY(80px);background:#2c2c2c;color:#fff;padding:0.6rem 1.2rem;border-radius:20px;font-family:'DM Sans',sans-serif;font-size:0.8rem;z-index:200;transition:transform 0.3s ease,opacity 0.3s ease;opacity:0;display:flex;align-items:center;gap:0.5rem;white-space:nowrap; }
    .saving-toast.show{transform:translateX(-50%) translateY(0);opacity:1}
    .spinner { width:14px;height:14px;border:2px solid rgba(255,255,255,0.3);border-top-color:#fff;border-radius:50%;animation:spin 0.7s linear infinite;display:none;flex-shrink:0; }
    .spinner.visible{display:block}

    /* LOGIN MODAL */
    .modal-overlay { display:none;position:fixed;inset:0;background:rgba(250,249,247,0.9);backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);align-items:center;justify-content:center;z-index:100;padding:1rem; }
    .modal-overlay.open{display:flex}
    .modal-box { background:#fff;border-radius:18px;padding:2rem 1.75rem;width:100%;max-width:360px;box-shadow:0 24px 64px rgba(0,0,0,0.13);animation:scaleIn 0.22s ease; }
    .modal-box.shake{animation:shake 0.4s ease}
    .modal-title { font-size:1.12rem;font-weight:700;color:#1a1a1a;font-family:'Lora',Georgia,serif;margin:0 0 5px; }
    .modal-sub { font-size:0.8rem;color:#aaa;font-family:'DM Sans',sans-serif;margin:0 0 1.4rem;line-height:1.5; }
    .modal-input { width:100%;padding:0.85rem 1rem;border-radius:10px;border:1.5px solid #e0dcd8;font-size:1rem;outline:none;font-family:'DM Sans',sans-serif;background:#faf9f7;color:#1a1a1a;min-height:50px;transition:border-color 0.18s;display:block; }
    .modal-input.error{border-color:#e0827c}
    .modal-error { font-size:0.73rem;color:#e0827c;font-family:'DM Sans',sans-serif;margin:0.4rem 0 1rem;display:none; }
    .modal-error.visible{display:block}
    .modal-btns { display:flex;gap:0.6rem; }
    .modal-btns .btn-ghost,.modal-btns .btn-primary{flex:1}
    .modal-hint { font-size:0.67rem;color:#d0c8c0;text-align:center;margin:1.2rem 0 0;font-family:'DM Sans',sans-serif; }

    /* FOOTER */
    .site-footer { border-top:1px solid #ece9e4;padding:1.4rem 1rem calc(1.4rem + env(safe-area-inset-bottom,0px));text-align:center;color:#c8c0b8;font-family:'DM Sans',sans-serif;font-size:0.7rem;letter-spacing:0.08em; }

    /* LOADING */
    #loading-screen { min-height:100vh;display:flex;align-items:center;justify-content:center;background:#faf9f7; }
    #loading-screen span { color:#c0b8b0;font-family:Georgia,serif;font-size:0.9rem;letter-spacing:0.2em; }
  </style>
</head>
<body>

<!-- LOADING -->
<div id="loading-screen"><span>loading...</span></div>

<!-- TOAST -->
<div class="saving-toast" id="toast">
  <div class="spinner" id="toast-spinner"></div>
  <span id="toast-msg">Saving‚Ä¶</span>
</div>

<!-- LOGIN MODAL -->
<div class="modal-overlay" id="login-modal">
  <div class="modal-box" id="login-box">
    <p class="modal-title">Admin Access</p>
    <p class="modal-sub">Enter your password to write and manage posts</p>
    <input class="modal-input" type="password" id="pw-input" placeholder="Password" />
    <p class="modal-error" id="pw-error">Incorrect password ‚Äî try again</p>
    <div class="modal-btns">
      <button class="btn-ghost" id="modal-cancel">Cancel</button>
      <button class="btn-primary" id="modal-enter">Enter</button>
    </div>
    <p class="modal-hint">Default password: <em>myblog2024</em></p>
  </div>
</div>

<!-- HOME VIEW -->
<div class="view" id="view-home">
  <nav class="site-nav">
    <span class="nav-logo">‚ú¶ My Blog</span>
    <div class="nav-right">
      <button class="btn-primary btn-nav-new" id="nav-new-btn" style="display:none">Ôºã New Post</button>
      <button class="btn-text" id="nav-admin-btn">Admin</button>
    </div>
  </nav>
  <header class="hero">
    <h1>Thoughts, stories<br>&amp; ideas.</h1>
    <p>A personal space for writing. No algorithm, no noise ‚Äî just words.</p>
    <div class="hero-divider"></div>
  </header>
  <main class="posts-main">
    <div id="posts-grid" class="posts-grid"></div>
    <div id="empty-state" class="empty-state" style="display:none">
      <p id="empty-text">No posts yet. Check back soon.</p>
      <button class="btn-primary" id="empty-write-btn" style="display:none">Write a Post</button>
    </div>
  </main>
  <button class="fab" id="fab-btn" aria-label="New Post">Ôºã</button>
  <footer class="site-footer">Made with care ¬∑ <span id="footer-year"></span></footer>
</div>

<!-- POST VIEW -->
<div class="view" id="view-post">
  <nav class="post-nav">
    <button class="btn-back" id="post-back-btn">‚Üê Back</button>
    <div class="post-admin-btns" id="post-admin-btns" style="display:none">
      <button class="btn-ghost" id="post-edit-btn" style="padding:0.45rem 0.8rem;font-size:0.8rem">Edit</button>
      <button class="btn-danger" id="post-delete-btn" style="padding:0.45rem 0.8rem;font-size:0.8rem">Delete</button>
    </div>
  </nav>
  <!-- article content injected here -->
  <article class="post-article" id="post-article"></article>

  <!-- like / share / comment actions -->
  <div class="post-actions">
    <div class="actions-bar">
      <button class="action-btn like-btn" id="like-btn">
        <span class="icon">‚ô°</span>
        <span id="like-count">0</span>
      </button>
      <button class="action-btn" id="share-btn">
        <span class="icon">‚Üó</span>
        <span>Share</span>
      </button>
    </div>
  </div>

  <!-- comments -->
  <div class="comments-section">
    <p class="comments-title" id="comments-title">Comments</p>

    <div class="comment-form">
      <input class="comment-name-input" id="comment-name" placeholder="Your name" maxlength="50" />
      <textarea class="comment-text-input" id="comment-text" placeholder="Write a comment‚Ä¶" maxlength="1000"></textarea>
      <div class="comment-form-footer">
        <button class="btn-post-comment" id="post-comment-btn" disabled>Post</button>
      </div>
    </div>

    <div class="comments-list" id="comments-list"></div>
  </div>
</div>

<!-- EDITOR VIEW -->
<div class="view" id="view-editor">
  <div class="editor-topbar">
    <span class="editor-label" id="editor-label">‚ú¶ New Post</span>
    <div class="editor-topbar-btns">
      <button class="btn-ghost" id="editor-cancel-btn" style="padding:0.5rem 0.9rem">Cancel</button>
      <button class="btn-primary" id="editor-publish-btn" style="padding:0.5rem 0.9rem" disabled>Publish</button>
    </div>
  </div>
  <div class="editor-body-wrap">
    <div class="cover-upload-zone" id="cover-zone">
      <div class="cover-upload-placeholder" id="cover-placeholder">
        <div class="icon">üì∑</div>
        <div class="hint">Tap to add a cover image</div>
      </div>
      <button class="cover-remove-btn" id="cover-remove-btn" style="display:none">‚úï</button>
    </div>
    <input type="file" accept="image/*" capture="environment" id="cover-file-input" style="display:none" />
    <input class="editor-title-input" id="editor-title" placeholder="Post title..." />
    <textarea class="editor-content-input" id="editor-content" placeholder="Write your story here..."></textarea>
    <div class="editor-footer" id="editor-footer">0 words ¬∑ 1 min read</div>
  </div>
</div>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  ‚ñº‚ñº‚ñº  PASTE YOUR VALUES HERE ‚Äî NOTHING ELSE TO CHANGE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const API_KEY        = "$2a$10$LaPAoeG9zOdltTMVU4c3w.tt5A1p8pmaFGHoucRu8gzKG0D1Z6.Q2";
const BIN_ID         = "6991996d43b1c97be9807dfb";
const ADMIN_PASSWORD = "myblog2024";
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

const BASE = "https://api.jsonbin.io/v3";

// ‚îÄ‚îÄ STATE ‚îÄ‚îÄ
let posts            = [];
let isAdmin          = false;
let currentPostId    = null;
let editingPost      = null;
let editorCoverImage = null;
// track which posts the current browser session has liked
const likedPosts = new Set(JSON.parse(localStorage.getItem("likedPosts") || "[]"));

// ‚îÄ‚îÄ HELPERS ‚îÄ‚îÄ
function estimateReadTime(t) { return Math.ceil(t.trim().split(/\s+/).filter(Boolean).length/200)+" min read"; }
function wordCount(t) { const w=t.trim().split(/\s+/).filter(Boolean).length; return w+" word"+(w!==1?"s":""); }
function formatDate(iso) { return new Date(iso).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}); }
function formatCommentDate(iso) {
  const d = new Date(iso);
  return d.toLocaleDateString("en-US",{month:"short",day:"numeric"}) + " ¬∑ " +
         d.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"});
}
function escapeHtml(s) { return String(s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"); }

let _tt=null;
function showToast(msg,spin=false) {
  document.getElementById("toast-msg").textContent=msg;
  document.getElementById("toast-spinner").classList.toggle("visible",spin);
  document.getElementById("toast").classList.add("show");
  if(_tt) clearTimeout(_tt);
  if(!spin) _tt=setTimeout(()=>document.getElementById("toast").classList.remove("show"),2400);
}
function hideToast() { document.getElementById("toast").classList.remove("show"); if(_tt) clearTimeout(_tt); }

// ‚îÄ‚îÄ JSONBIN ‚îÄ‚îÄ
async function fetchPosts() {
  const r = await fetch(`${BASE}/b/${BIN_ID}/latest`, { headers:{"X-Master-Key":API_KEY} });
  if (!r.ok) throw new Error(r.status);
  const d = await r.json();
  return d.record.posts || [];
}

async function savePosts(arr) {
  const r = await fetch(`${BASE}/b/${BIN_ID}`, {
    method:"PUT",
    headers:{"Content-Type":"application/json","X-Master-Key":API_KEY},
    body:JSON.stringify({posts:arr})
  });
  if (!r.ok) throw new Error(r.status);
  posts = arr;
}

// ‚îÄ‚îÄ VIEWS ‚îÄ‚îÄ
function showView(id) {
  document.querySelectorAll(".view").forEach(v=>v.classList.remove("active"));
  document.getElementById("view-"+id).classList.add("active");
  window.scrollTo(0,0);
}

// ‚îÄ‚îÄ HOME ‚îÄ‚îÄ
function renderHome() {
  const grid    = document.getElementById("posts-grid");
  const empty   = document.getElementById("empty-state");
  const navNew  = document.getElementById("nav-new-btn");
  const fab     = document.getElementById("fab-btn");
  const adminBtn= document.getElementById("nav-admin-btn");

  adminBtn.textContent = isAdmin ? "Sign out" : "Admin";
  navNew.style.display = isAdmin ? "" : "none";
  fab.classList.toggle("visible", isAdmin);

  if (posts.length === 0) {
    grid.innerHTML=""; grid.style.display="none";
    empty.style.display="block";
    document.getElementById("empty-text").textContent = isAdmin ? "No posts yet. Write your first one!" : "No posts yet. Check back soon.";
    document.getElementById("empty-write-btn").style.display = isAdmin ? "inline-flex" : "none";
  } else {
    empty.style.display="none"; grid.style.display="";
    grid.innerHTML = posts.map((p,i)=>`
      <div class="post-card" data-id="${escapeHtml(p.id)}" style="animation-delay:${i*55}ms">
        ${p.coverImage?`<img class="post-card-img" src="${escapeHtml(p.coverImage)}" alt="" loading="lazy"/>`:""}
        <div class="post-card-body">
          <div class="post-meta"><span>${formatDate(p.date)}</span><span class="dot">¬∑</span><span>${escapeHtml(p.readTime)}</span></div>
          <h2 class="post-card-title">${escapeHtml(p.title)}</h2>
          <p class="post-card-excerpt">${escapeHtml(p.content)}</p>
          <div class="post-card-footer">
            <span class="card-read-more">Read more ‚Üí</span>
            <span class="card-likes">‚ô° ${p.likes||0}</span>
          </div>
        </div>
      </div>`).join("");
    grid.querySelectorAll(".post-card").forEach(c=>c.addEventListener("click",()=>openPost(c.dataset.id)));
  }
  document.getElementById("footer-year").textContent = new Date().getFullYear();
  showView("home");
}

// ‚îÄ‚îÄ POST VIEW ‚îÄ‚îÄ
function openPost(id) {
  const p = posts.find(x=>x.id===id); if(!p) return;
  currentPostId = id;

  document.getElementById("post-admin-btns").style.display = isAdmin ? "flex" : "none";
  document.getElementById("post-article").innerHTML = `
    ${p.coverImage?`<img class="post-cover-img" src="${escapeHtml(p.coverImage)}" alt="cover"/>`:""}
    <div class="post-meta"><span>${formatDate(p.date)}</span><span class="dot">¬∑</span><span>${escapeHtml(p.readTime)}</span></div>
    <h1>${escapeHtml(p.title)}</h1>
    <div class="prose">${escapeHtml(p.content)}</div>`;

  // Render like button
  renderLikeBtn(p);

  // Render comments
  renderComments(p);

  showView("post");
}

// ‚îÄ‚îÄ LIKES ‚îÄ‚îÄ
function renderLikeBtn(p) {
  const btn = document.getElementById("like-btn");
  const hasLiked = likedPosts.has(p.id);
  btn.classList.toggle("liked", hasLiked);
  btn.querySelector(".icon").textContent = hasLiked ? "‚ô•" : "‚ô°";
  document.getElementById("like-count").textContent = p.likes || 0;
}

async function handleLike() {
  const p = posts.find(x=>x.id===currentPostId); if(!p) return;
  const hasLiked = likedPosts.has(p.id);

  // Optimistic update
  p.likes = (p.likes || 0) + (hasLiked ? -1 : 1);
  if (hasLiked) likedPosts.delete(p.id); else likedPosts.add(p.id);
  localStorage.setItem("likedPosts", JSON.stringify([...likedPosts]));
  renderLikeBtn(p);

  // Also update card on home if visible
  const card = document.querySelector(`.post-card[data-id="${p.id}"] .card-likes`);
  if (card) card.textContent = "‚ô° " + p.likes;

  try {
    await savePosts([...posts]);
  } catch(e) {
    // Revert on failure
    p.likes = (p.likes || 0) + (hasLiked ? 1 : -1);
    if (hasLiked) likedPosts.add(p.id); else likedPosts.delete(p.id);
    localStorage.setItem("likedPosts", JSON.stringify([...likedPosts]));
    renderLikeBtn(p);
    showToast("Couldn't save like ‚Äî try again");
  }
}

// ‚îÄ‚îÄ SHARE ‚îÄ‚îÄ
async function handleShare() {
  const p = posts.find(x=>x.id===currentPostId); if(!p) return;
  const url = window.location.href;
  const shareData = { title: p.title, text: p.content.slice(0,120)+"‚Ä¶", url };
  if (navigator.share) {
    try { await navigator.share(shareData); } catch(e) {}
  } else {
    // Fallback: copy URL
    try {
      await navigator.clipboard.writeText(url);
      showToast("Link copied ‚úì");
    } catch(e) {
      showToast("Copy this link: " + url);
    }
  }
}

// ‚îÄ‚îÄ COMMENTS ‚îÄ‚îÄ
function renderComments(p) {
  const comments = p.comments || [];
  const list = document.getElementById("comments-list");
  const title = document.getElementById("comments-title");

  title.textContent = comments.length > 0
    ? `${comments.length} Comment${comments.length !== 1 ? "s" : ""}`
    : "Comments";

  if (comments.length === 0) {
    list.innerHTML = `<p class="no-comments">No comments yet ‚Äî be the first!</p>`;
    return;
  }

  list.innerHTML = comments.map(c => `
    <div class="comment-item" data-cid="${escapeHtml(c.id)}">
      <div class="comment-header">
        <span class="comment-author">${escapeHtml(c.author)}</span>
        <div style="display:flex;align-items:center;gap:0.5rem">
          <span class="comment-date">${formatCommentDate(c.date)}</span>
          ${isAdmin ? `<button class="comment-delete" data-cid="${escapeHtml(c.id)}" title="Delete">‚úï</button>` : ""}
        </div>
      </div>
      <p class="comment-text">${escapeHtml(c.text)}</p>
    </div>`).join("");

  // Delete buttons (admin only)
  if (isAdmin) {
    list.querySelectorAll(".comment-delete").forEach(btn => {
      btn.addEventListener("click", e => {
        e.stopPropagation();
        handleDeleteComment(btn.dataset.cid);
      });
    });
  }
}

function updatePostCommentBtn() {
  const name = document.getElementById("comment-name").value.trim();
  const text = document.getElementById("comment-text").value.trim();
  document.getElementById("post-comment-btn").disabled = !(name && text);
}

async function handlePostComment() {
  const author = document.getElementById("comment-name").value.trim();
  const text   = document.getElementById("comment-text").value.trim();
  if (!author || !text) return;

  const p = posts.find(x=>x.id===currentPostId); if(!p) return;
  const comment = { id: "c_"+Date.now(), author, text, date: new Date().toISOString() };
  p.comments = [comment, ...(p.comments||[])];

  showToast("Posting‚Ä¶", true);
  try {
    await savePosts([...posts]);
    document.getElementById("comment-name").value = "";
    document.getElementById("comment-text").value = "";
    document.getElementById("post-comment-btn").disabled = true;
    hideToast();
    showToast("Comment posted ‚úì");
    renderComments(p);
  } catch(e) {
    p.comments = (p.comments||[]).filter(c=>c.id!==comment.id);
    showToast("Error posting comment");
  }
}

async function handleDeleteComment(commentId) {
  if (!confirm("Delete this comment?")) return;
  const p = posts.find(x=>x.id===currentPostId); if(!p) return;
  p.comments = (p.comments||[]).filter(c=>c.id!==commentId);
  showToast("Deleting‚Ä¶", true);
  try {
    await savePosts([...posts]);
    hideToast();
    renderComments(p);
  } catch(e) {
    showToast("Error deleting comment");
  }
}

// ‚îÄ‚îÄ EDITOR ‚îÄ‚îÄ
function openEditor(post=null) {
  editingPost=post; editorCoverImage=post?.coverImage||null;
  document.getElementById("editor-label").textContent = post?"‚ú¶ Edit":"‚ú¶ New Post";
  document.getElementById("editor-title").value   = post?.title||"";
  document.getElementById("editor-content").value = post?.content||"";
  updateCoverZone(); updateEditorFooter(); updatePublishBtn();
  showView("editor");
}

function updateCoverZone() {
  const zone=document.getElementById("cover-zone");
  const ph=document.getElementById("cover-placeholder");
  const rb=document.getElementById("cover-remove-btn");
  const old=zone.querySelector("img"); if(old) old.remove();
  if (editorCoverImage) {
    const img=document.createElement("img");
    img.src=editorCoverImage;
    img.style.cssText="position:absolute;inset:0;width:100%;height:100%;object-fit:cover;";
    zone.insertBefore(img,zone.firstChild);
    ph.style.display="none"; rb.style.display="flex";
    zone.style.height="auto"; zone.style.minHeight="130px";
  } else {
    ph.style.display="block"; rb.style.display="none";
    zone.style.height=""; zone.style.minHeight="";
  }
}

function updateEditorFooter() {
  const c=document.getElementById("editor-content").value;
  document.getElementById("editor-footer").textContent=wordCount(c)+" ¬∑ "+estimateReadTime(c);
}

function updatePublishBtn() {
  const t=document.getElementById("editor-title").value.trim();
  const b=document.getElementById("editor-publish-btn");
  b.disabled=!t; b.style.background=t?"#2c2c2c":"#ccc"; b.style.cursor=t?"pointer":"not-allowed";
}

async function handlePublish() {
  const title  =document.getElementById("editor-title").value.trim();
  const content=document.getElementById("editor-content").value.trim();
  if(!title) return;
  showToast("Saving‚Ä¶",true);
  const post = {
    id:         editingPost?.id||"post_"+Date.now(),
    title, content,
    coverImage: editorCoverImage,
    date:       editingPost?.date||new Date().toISOString(),
    readTime:   estimateReadTime(content),
    likes:      editingPost?.likes||0,
    comments:   editingPost?.comments||[]
  };
  const updated = editingPost
    ? posts.map(p=>p.id===editingPost.id?post:p)
    : [post,...posts];
  try {
    await savePosts(updated);
    editingPost=null; hideToast(); showToast("Published ‚úì"); renderHome();
  } catch(e) { console.error(e); showToast("Error saving ‚Äî check console"); }
}

// ‚îÄ‚îÄ LOGIN ‚îÄ‚îÄ
function openLogin() {
  document.getElementById("pw-input").value="";
  document.getElementById("pw-error").classList.remove("visible");
  document.getElementById("pw-input").classList.remove("error");
  document.getElementById("login-box").classList.remove("shake");
  document.getElementById("login-modal").classList.add("open");
  setTimeout(()=>document.getElementById("pw-input").focus(),50);
}
function closeLogin() { document.getElementById("login-modal").classList.remove("open"); }
function tryLogin() {
  if (document.getElementById("pw-input").value===ADMIN_PASSWORD) {
    isAdmin=true; closeLogin(); renderHome();
  } else {
    document.getElementById("pw-error").classList.add("visible");
    document.getElementById("pw-input").classList.add("error");
    const b=document.getElementById("login-box");
    b.classList.remove("shake"); void b.offsetWidth; b.classList.add("shake");
  }
}

// ‚îÄ‚îÄ EVENTS ‚îÄ‚îÄ
function initEvents() {
  document.getElementById("modal-cancel").addEventListener("click",closeLogin);
  document.getElementById("modal-enter").addEventListener("click",tryLogin);
  document.getElementById("pw-input").addEventListener("keydown",e=>{if(e.key==="Enter")tryLogin();});
  document.getElementById("pw-input").addEventListener("input",()=>{
    document.getElementById("pw-error").classList.remove("visible");
    document.getElementById("pw-input").classList.remove("error");
  });
  document.getElementById("nav-admin-btn").addEventListener("click",()=>{if(isAdmin){isAdmin=false;renderHome();}else openLogin();});
  document.getElementById("nav-new-btn").addEventListener("click",()=>openEditor());
  document.getElementById("fab-btn").addEventListener("click",()=>openEditor());
  document.getElementById("empty-write-btn").addEventListener("click",()=>openEditor());
  document.getElementById("post-back-btn").addEventListener("click",()=>renderHome());
  document.getElementById("post-edit-btn").addEventListener("click",()=>{const p=posts.find(x=>x.id===currentPostId);if(p)openEditor(p);});
  document.getElementById("post-delete-btn").addEventListener("click",async()=>{
    if(!confirm("Delete this post?")) return;
    showToast("Deleting‚Ä¶",true);
    try{ await savePosts(posts.filter(p=>p.id!==currentPostId)); currentPostId=null; hideToast(); showToast("Deleted"); renderHome(); }
    catch(e){ console.error(e); showToast("Error ‚Äî check console"); }
  });
  document.getElementById("editor-cancel-btn").addEventListener("click",()=>{editingPost=null;if(currentPostId)openPost(currentPostId);else renderHome();});
  document.getElementById("editor-publish-btn").addEventListener("click",handlePublish);
  document.getElementById("editor-title").addEventListener("input",updatePublishBtn);
  document.getElementById("editor-content").addEventListener("input",updateEditorFooter);
  document.getElementById("cover-zone").addEventListener("click",()=>document.getElementById("cover-file-input").click());
  document.getElementById("cover-remove-btn").addEventListener("click",e=>{e.stopPropagation();editorCoverImage=null;updateCoverZone();});
  document.getElementById("cover-file-input").addEventListener("change",e=>{
    const f=e.target.files[0]; if(!f) return;
    const r=new FileReader();
    r.onload=ev=>{editorCoverImage=ev.target.result;updateCoverZone();};
    r.readAsDataURL(f); e.target.value="";
  });

  // Like & Share
  document.getElementById("like-btn").addEventListener("click", handleLike);
  document.getElementById("share-btn").addEventListener("click", handleShare);

  // Comments
  document.getElementById("comment-name").addEventListener("input", updatePostCommentBtn);
  document.getElementById("comment-text").addEventListener("input", updatePostCommentBtn);
  document.getElementById("post-comment-btn").addEventListener("click", handlePostComment);
}

// ‚îÄ‚îÄ INIT ‚îÄ‚îÄ
async function init() {
  initEvents();
  try { posts=await fetchPosts(); }
  catch(e){ console.error("Could not load posts:",e); posts=[]; }
  document.getElementById("loading-screen").style.display="none";
  renderHome();
}

init();
</script>
</body>
</html>